# Guide to Docker Volumes

Docker volumes are a way to persist data generated by and used by Docker containers. They are especially useful for sharing data between containers or persisting data beyond the life cycle of a single container.

## Types of Docker Volumes

There are several types of Docker volumes:

1. **Named volumes**: These are volumes with a specific name assigned by the user.
2. **Anonymous volumes**: These are volumes that Docker creates automatically. They are not given a specific name.
3. **Host volumes**: These are directories from the host machine mounted into a container.

## Creating a Docker Volume

To create a named volume, you can use the following command:

```bash
docker volume create {volume_name}
```

## Using a Docker Volume

### Example: MySQL Database

Let's say you have a MySQL database running in a Docker container. You can use a named volume to persist the database data even if the container is stopped or removed.

First, create a named volume:

```bash
docker volume create mysql_data
```

Then, run the MySQL container with the volume mounted:

```bash
docker run -d --rm \
  --name mysql-container \
  -e MYSQL_ROOT_PASSWORD=my-secret-pw \
  -v mysql_data:/var/lib/mysql \
  --memory=512m \
  --cpus=0.5 \
  mysql:latest \
  --default-authentication-plugin=mysql_native_password

```

or this for windows

```bash
docker run -d --rm --name mysql-container -e MYSQL_ROOT_PASSWORD=my-secret-pw -v mysql_data:/var/lib/mysql --memory=512m --cpus=0.5 mysql:latest --default-authentication-plugin=mysql_native_password

```

try to run the container without volume

```bash
docker run -d --rm --name mysql-container-non-volume -e MYSQL_ROOT_PASSWORD=my-secret-pw --memory=512m --cpus=0.5 mysql:latest --default-authentication-plugin=mysql_native_password

```

In this example:

- `-e`: This flag is used to set environment variables inside the Docker container.
- `-v mysql_data:/var/lib/mysql`: mounts the mysql_data volume to the /var/lib/mysql directory inside the container.
- `MYSQL_ROOT_PASSWORD=my-secret-pw`: This is the environment variable being set. In this case, it's setting the MySQL root user's password to my-secret-pw.
- `--memory=128m`: sets the maximum amount of memory that the container can use to 128MB.
- `--cpus=0.5`: restricts the container to use a maximum of 0.5 CPU cores (50% of a single core).
- `mysql:latest`: is the MySQL Docker image.
- `--default-authentication-plugin=mysql_native_password` is added at the end of the docker run command to specifies the default authentication plugin for MySQL.

Now, even if you stop or remove the mysql-container, the data stored in the /var/lib/mysql directory will persist in the mysql_data volume.
Managing Docker Volumes

You can list, inspect, and remove Docker volumes using the following commands:

- `docker volume ls`: List all Docker volumes.
- `docker volume inspect <volume_name>`: Inspect details about a specific volume.
- `docker volume rm <volume_name>`: Remove a specific volume.

### Example: Nginx

Let's say you have a Nginx running in a Docker container. You use a custome index.html to be served with nginx, you can use host volume to eliminate rebuild the dockerfile everytime you update your index.html.

First, make the index.html to be served by nginx:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to NGINX</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }
        .container {
            width: 80%;
            margin: 50px auto;
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        p {
            font-size: 18px;
            line-height: 1.6;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Welcome to NGINX</h1>
        <p>This is a simple webpage volumed on host served by NGINX inside a Docker container.</p>
        <p>Feel free to explore and customize!</p>
    </div>
</body>
</html>


```

Then, run the nginx container with the file index.html mounted:

```bash
docker run -d --rm --name nginx -p 8081:80 -v ./index.html:/usr/share/nginx/html/index.html nginx:alpine 

```

Then try to update your index.html file and check if the web served by nginx is also changed
